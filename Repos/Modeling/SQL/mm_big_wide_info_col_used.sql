DROP TABLE IF EXISTS marketing_modeling.app_model_input_data;
CREATE TABLE IF NOT EXISTS marketing_modeling.app_model_input_data 
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
STORED AS TEXTFILE
AS 
SELECT
  mobile,
  d_fir_leads_time,
  d_fir_sec_leads_diff,
  d_leads_count,
  d_avg_leads_date,
  d_leads_dtbt_count,
  d_leads_dtbt_coincide,
  d_leads_dtbt_level_1,
  d_cust_type,
  d_fir_card_time,
  d_card_ttl,
  d_fir_visit_time,
  d_visit_dtbt_count,
  d_visit_ttl,
  d_avg_visit_date,
  d_avg_visit_dtbt_count,
  d_fir_trail,
  d_last_reservation_time,
  d_trail_book_tll,
  d_leads_car_model_count,
  d_leads_car_model_type,
  d_fir_dealfail_d,
  d_last_dealfail_d,
  d_is_deposit_order,
  d_deal_flag,
  d_avg_fircard_firvisit_diff,
  d_activity_ttl,
  d_followup_d7,
  d_followup_d15,
  d_followup_d30,
  d_followup_d60,
  d_followup_d90,
  d_firlead_dealf_diff,
  d_lastlead_dealf_diff,
  d_last_dfail_dealf_diff,
  d_lasttrail_dealf_diff,
  d_leads_dtbt_ppt,
  d_fircard_firvisit_diff,
  c_trail_vel,
  c_lead_sources,
  c_last_activity_time,
  c_lead_model,
  c_sex,
  c_age,
  c_city,
  h_loan,
  h_model_nums,
  h_have_car,
  h_compete_car_num_d30,
  h_compete_car_num_d60,
  h_compete_car_num_d90,
  h_focusing_avg_diff,
  h_focusing_max_diff,
  h_func_prefer,
  h_car_type_prefer,
  h_config_prefer,
  h_budget,
  h_level,
  h_volume,
  h_ttl_inquiry_time,
  h_produce_way,
  d_leads_dtbt_level_2,
  d_fir_sec_visit_diff,
  d_followup_ttl,
  d_avg_fir_sec_visit_diff,
  d_avg_firleads_firvisit_diff,
  d_trail_count_d30,
  d_visit_count_d15,
  d_visit_count_d30,
  d_visit_count_d90,
  d_firfollow_dealf_diff,
  d_dealf_firvisit_diff,
  d_firleads_firvisit_diff,
  c_register_time,
  c_last_reach_platform
FROM marketing_modeling.app_big_wide_info
WHERE SUBSTR(mobile, 0, 1) = 1 AND LENGTH(mobile) = 11
  and pt='${pt}'
